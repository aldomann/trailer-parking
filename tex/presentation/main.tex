%-----------------------------------------------------------------
%	BASIC DOCUMENT LAYOUT
%-----------------------------------------------------------------
\documentclass{beamer}

% \usepackage[scaled]{helvet}
% \renewcommand\familydefault{\sfdefault}
\usefonttheme[onlymath]{serif}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{microtype}
\usepackage[british]{babel}
\usepackage{url}
\usepackage{ru-theme}

\usepackage[backend=bibtex, style=trad-abbrv, sorting=none, maxbibnames=3, maxcitenames=2]{biblatex}
\addbibresource{bibliography.bib}
\makeatletter
	\def\blx@maxline{77}
\makeatother

\usepackage{array}
\usepackage{multirow}

\usepackage{multimedia}

%-----------------------------------------------------------------
%	MISC STUFF
%-----------------------------------------------------------------
\definecolor{mygreen}{RGB}{46,139,87}
\definecolor{mybrown}{RGB}{136,58,19}
\definecolor{myorange}{RGB}{241,122,60}

\newcommand{\Plus}{\mathord{\begin{tikzpicture}[baseline=0ex, line width=1, scale=0.13]
\draw (1,0) -- (1,2);
\draw (0,1) -- (2,1);
\end{tikzpicture}}}

\setbeamercovered{transparent}
\usepackage{tabularx}
\usepackage{float}
\usepackage{booktabs}
\usepackage{subfig}
% \usepackage{subcaption}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
% Theorem environment	
\usepackage{amsthm}
\newtheorem{mydef}{Definition}
\newtheorem{myprop}{Proposition}
\newtheorem{mythm}{Theorem}
\newtheorem{mylem}{Lemma}
\newtheorem{mycor}{Corollary}
\newtheorem{myrem}{Remark}
\DeclareMathOperator{\Det}{det}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\Rank}{rank}
\DeclareMathOperator{\Deg}{deg}

\AtBeginBibliography{\footnotesize}

%-----------------------------------------------------------------
%	LISTINGS
%-----------------------------------------------------------------
% \makeatletter

% \newcount\bt@rangea
% \newcount\bt@rangeb

% \newcommand\btIfInRange[2]{%
%     \global\let\bt@inrange\@secondoftwo%
%     \edef\bt@rangelist{#2}%
%     \foreach \range in \bt@rangelist {%
%         \afterassignment\bt@getrangeb%
%         \bt@rangea=0\range\relax%
%         \pgfmathtruncatemacro\result{ ( #1 >= \bt@rangea) && (#1 <= \bt@rangeb) }%
%         \ifnum\result=1\relax%
%             \breakforeach%
%             \global\let\bt@inrange\@firstoftwo%
%         \fi%
%     }%
%     \bt@inrange%
% }
% \newcommand\bt@getrangeb{%
%     \@ifnextchar\relax%
%         {\bt@rangeb=\bt@rangea}%
%         {\@getrangeb}%
% }
% \def\@getrangeb-#1\relax{%
%     \ifx\relax#1\relax%
%         \bt@rangeb=100000%   \maxdimen is too large for pgfmath
%     \else%
%         \bt@rangeb=#1\relax%
%     \fi%
% }

% \newcommand<>{\btLstHL}[1]{%
%   \only#2{\btIfInRange{\value{lstnumber}}{#1}{\color{orange!30}\def\lst@linebgrdcmd{\color@block}}{\def\lst@linebgrdcmd####1####2####3{}}}%
% }%
% \makeatother

% \makeatletter
% \newenvironment{btHighlight}[1][]
% {\begingroup\tikzset{bt@Highlight@par/.style={#1}}\begin{lrbox}{\@tempboxa}}
% {\end{lrbox}\bt@HL@box[bt@Highlight@par]{\@tempboxa}\endgroup}

% \newcommand\btHL[1][]{%
%   \begin{btHighlight}[#1]\bgroup\aftergroup\bt@HL@endenv%
% }
% \def\bt@HL@endenv{%
%   \end{btHighlight}%
%   \egroup
% }
% \newcommand{\bt@HL@box}[2][]{%
%   \tikz[#1]{%
%     \pgfpathrectangle{\pgfpoint{1pt}{0pt}}{\pgfpoint{\wd #2}{\ht #2}}%
%     \pgfusepath{use as bounding box}%
%     \node[anchor=base west, fill=orange!30,outer sep=0pt,inner xsep=1pt, inner ysep=0pt, rounded corners=3pt, minimum height=\ht\strutbox+1pt,#1]{\raisebox{1pt}{\strut}\strut\usebox{#2}};
%   }%
% }
% \makeatother

\usepackage[formats]{listings}
\usepackage{relsize}
\usepackage{chngcntr}
% \usepackage{lstlinebgrd}

\definecolor{keywords}{HTML}{268bd2}
\definecolor{background}{HTML}{eee8d5}
\definecolor{comments}{HTML}{586e75}

\lstdefinelanguage{mymatlab}[]{matlab}{%
	morekeywords={ss, lsim, place, rscale, curve1, curve2, curve3, curve4}
	}

\lstloadlanguages{matlab,python}
\lstset{language=matlab,
		basicstyle=\smaller\ttfamily,
		% keywordstyle=\bfseries,
		% morecomment=[l][\color{magenta}]{\#},
		keywordstyle=\color{keywords},
		commentstyle=\color{comments}\itshape,
		% backgroundcolor=\color{background},
		frame=tb,
		tabsize=2,
		breaklines=true,
		breakatwhitespace=true,
		numbers=left,
		numberstyle=\tiny,
		numbersep=7.5pt,
		xleftmargin=3ex}
\lstset{escapeinside={(*}{*)}}

% \lstset{language=matlab,
% 		frame=tb,
% 		% captionpos=b,
% 		tabsize=2,
% 		% showtabs=true,
% 		breaklines=true,
% 		breakatwhitespace=true,
% 		basicstyle=\smaller\ttfamily,
% 		numbers=left,
% 		numberstyle=\tiny,
% 		numbersep=7.5pt,
% 		% commentstyle=\textsl,
% 		xleftmargin=3ex}
% \lstset{escapeinside={(*}{*)}}   % for (*\ref{ }*) inside lstlistings (Scode)

\expandafter\patchcmd\csname \string\lstinline\endcsname{%
	\leavevmode
	\bgroup
}{%
	\leavevmode
	\ifmmode\hbox\fi
	\bgroup
}{}{%
	\typeout{Patching of \string\lstinline\space failed!}%
}
%% end of patch

\newcommand*{\inline}{\lstinline[basicstyle=\normalsize\ttfamily]}

%-----------------------------------------------------------------
%	MATHS AND SCIENCE
%-----------------------------------------------------------------
\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{xfrac}
\usepackage[a]{esvect}
\usepackage{chemformula}
\usepackage{graphicx}

\usepackage[arrowdel]{physics}
	\renewcommand{\vnabla}{\vec{\nabla}}
	\renewcommand{\vectorarrow}[1]{\vec{#1}}
	\renewcommand{\vectorunit}[1]{\hat{#1}}
	\renewcommand*{\grad}[1]{\vnabla #1}
	\renewcommand*{\div}[1]{\vnabla \vdot \va{#1}}
	\renewcommand*{\curl}[1]{\vnabla \cp \va{#1}}
	\let\rot\curl

% SI units
\usepackage[separate-uncertainty=true]{siunitx}
\sisetup{range-phrase = \text{--}, range-units = single}
\DeclareSIPrePower\quartic{4}

%-----------------------------------------------------------------
%	PDF INFO AND HYPERREF
%-----------------------------------------------------------------
\usepackage{hyperref}
% \hypersetup{colorlinks, citecolor=black, filecolor=black, linkcolor=black, urlcolor=black}
\usepackage{cleveref}
	\crefname{section}{\S}{\SS}
	\Crefname{section}{\S}{\SS}
	\crefname{listing}{snippet}{}

\newcommand*{\mytitle}{Control of a Trailer}
\newcommand*{\myshorttitle}{Control of a Trailer}
\newcommand*{\mysubtitle}{How to steer a car when parking}
\newcommand*{\myauthor}{Alfredo Hernández}
\newcommand*{\myauthora}{David Masip}
\newcommand*{\myauthorb}{Martí Municoy}
\newcommand*{\myauthorc}{Jan-Hendrik Niemann}
\newcommand*{\myuni}{Universitat Autònoma de Barcelona}
\newcommand*{\mydegree}{Modelling for Science and Engineering}
\newcommand*{\mydate}{2nd February 2018}

\pdfstringdefDisableCommands{\def\and{and }}

\usepackage{hyperxmp}
% \hypersetup{pdfauthor={\myauthor}, pdftitle={\mytitle: \mysubtitle}}
\hypersetup{pdfauthor={\myauthor}, pdftitle={\mytitle}}

%-----------------------------------------------------------------
%	TITLE SECTION AND DOCUMENT BEGINNING
%-----------------------------------------------------------------

\title[\mytitle]{\mytitle}

\subtitle{\mysubtitle}

\author[Team 7]{ \myauthor \and \myauthora \and \myauthorb \and \myauthorc }% \and \myauthora \and \myauthorb \and \myauthorc}

% \institute[]{\myuni { --} \mydegree}
\institute[]{\mydegree}

\date[\mydate]{\mydate}

\hypersetup{pdfauthor={\myauthor}, pdftitle={\mytitle: \mysubtitle}}

\begin{document}

\begin{frame}
	\titlepage
\end{frame}

%-----------------------------------------------------------------
%	DOCUMENT BODY
%-----------------------------------------------------------------
% \begin{frame}
% 	\frametitle{Outline}
% 	\tableofcontents
% \end{frame}

\input{contents/0-intro}
\input{contents/1-control}
\input{contents/2-model}
\input{contents/3-alt-control}
% \input{contents/4-experience}
\input{contents/9-conclusions}

%-----------------------------------------------------------------
\appendix
\begin{frame}{References}
% \begin{frame}[allowframebreaks]{References}
	\def\newblock{}
	\nocite{Nilsson2013}
	\nocite{steering}
	\nocite{jack}
	\nocite{Sontag1998}
	\nocite{Hinrichsen2005}
	\nocite{Hautus2001}
	\printbibliography[heading=bibintoc]
\end{frame}

\end{document}

